---
title: "Tarea 11"
author: "Martin Santamaria"
date: "29/8/2020"
output: html_document
---

```{r setup, include=FALSE}
Sys.setenv(RETICULATE_PYTHON = "/Python38")
knitr::opts_chunk$set(echo = TRUE)
library(reticulate)
```

### Ejercicio 1

```{r}
f_prob = function(x){
  sapply(x,function(x){
    if(x < 3 || x > 6){
      0;
    }else if((x >= 3 && x < 4) || (x == 6)){
      (1/3);
    }else if(x >= 4 && x < 6){
      (1/6);
    }
    });
}

u = function(x){
  (3)^x*(1/3)+(4)^x*(1/6)+(5)^x*(1/6)+(6)^x*(1/3);
}

u_central = function(x){
  (-3/2)^x*(1/3)+(-1/2)^x*(1/6)+(1/2)^x*(1/6)+(3/2)^x*(1/3);
}

c_asimetria = function(){
  u_central(3)/(u_central(2))^(3/2)
}

c_curtosis = function(){
  u_central(4)/((u_central(2))^2)
}
```

#### Gráfico

```{r}
plot(x = c(2:7),
     y = f_prob(c(2:7)),
     ylim = c(0,0.8),
     xlim = c(2,7),
     xlab = "x",
     pch = 19,
     col = 'blue',
     main = "Función de probabilidad")

lines(x = c(3,4,5,6),
      y = c(f_prob(3),f_prob(4),f_prob(5),f_prob(6)), 
      type = "h", 
      lty = 2,
      col="blue")

axis(1,seq(2,7,1))
```

Se observa que el gráfico carece de punta o pincho concordando con el valor de la curtosis (1,35) obtenido.

### Ejercicio 2

```{r}
f_prob = function(x){
  sapply(x,function(x){
    if(x < 0 || x > 2){
      0;
    }else {
      1/3;
    }
    });
}

u = function(x){
  (2^x+1)/3;
}

u_central = function(x){
  ((-1)^x+1)/3;
}

c_asimetria = function(){
  u_central(3)/(u_central(2))^(3/2)
}

c_curtosis = function(){
  u_central(4)/((u_central(2))^2)
}
```

#### Gráfico

```{r}
plot(x = c(-1:3),
     y = f_prob(c(-1:3)),
     ylim = c(0,0.5),
     xlim = c(-1,3),
     xlab = "x",
     pch = 19,
     col = 'blue',
     main = "Función de probabilidad")

lines(x = c(0,1,2),
      y = c(f_prob(0),f_prob(1),f_prob(2)), 
      type = "h", 
      lty = 2,
      col="blue")

axis(1,seq(-1,3,1))
```

Se observa que el gráfico carece de punta o pincho concordando con el valor de la curtosis (1,5) obtenido.

### Ejercicio 3

```{r}
f_den = function(x){
  sapply(x,function(x){
    if(x >= -1 && x <= 0){
      1 + x;
    }else if(x > 0 && x <= 1){
      1 - x;
    }else{
      0;
    }
    });
}

u = function(x){
  (1 + (-1)^x)/(x+1)*(x+2);
}

u_central = function(x){
  (1 + (-1)^x)/((x+1)*(x+2));
}

c_asimetria = function(){
  u_central(3)/(u_central(2))^(3/2)
}

c_curtosis = function(){
  u_central(4)/((u_central(2))^2)
}
```

#### Gráfico

```{r}
curve(f_den(x),
     ylim = c(0,1.2),
     xlim = c(-2,2),
     xlab = "x",
     col = 'blue',
     main = "Función de densidad")

axis(1,seq(-2,2,1))
```

Se observa que el gráfico posee punta o pincho concordando con el valor de la curtosis (2,4) obtenido.

### Ejercicio 4

$$\int{\left(t - \frac{1}{3} \right)^n \cdot t^{-\frac{1}{2}} \ dt} \ \ \ \ \ n \in \mathbb{N}$$

$$\int{\left(t - \frac{1}{3} \right)^n \cdot t^{-\frac{1}{2}} \ dt} = \sum_{k=0}^{n} \binom{n}{n - k}(-1)^{n-k}\frac{2t^{\frac{2k+1}{2}}}{(2k+1) \cdot 3^{n-k}}$$

```{r}
f_den = function(x){
  sapply(x,function(x){
    if(x > 0 && x <= 1){
      1/(2*sqrt(x))
    }else{
      0;
    }
    });
}

u = function(x){
  1/(2*x+1);
}

u_central = function(x){
  aux = x;
  
  sum(sapply(0:x,function(x){
    t = choose(aux,aux-x)*(((-1)^{aux-x})/((2*x+1)*3^(aux-x)))
    cumsum(t);
    }));
  
  # sum(sapply(0:x,function(x){
  #   t = choose(aux,x)*(-1)^x*(u(1)^x)*u(aux-x)
  #   cumsum(t);
  #   }));
}

c_asimetria = function(){
  u_central(3)/(u_central(2))^(3/2)
}

c_curtosis = function(){
  u_central(4)/((u_central(2))^2)
}
```

#### Gráfico

```{r}
curve(f_den(x),
     ylim = c(0,1.2),
     xlim = c(-2,2),
     xlab = "x",
     col = 'blue',
     main = "Función de densidad")

axis(1,seq(-2,2,1))
```

Se observa que el gráfico posee punta o pincho concordando con el valor de la curtosis (2,14) obtenido. 
